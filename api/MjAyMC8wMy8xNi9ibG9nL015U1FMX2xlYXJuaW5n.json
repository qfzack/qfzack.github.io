{"title":"学习笔记：MySQL数据库","date":"2020-03-17T05:00:00.000Z","date_formatted":{"ll":"Mar 17, 2020","L":"03/17/2020","MM-DD":"03-17"},"author":"Qingfeng Zhang","link":"2020/03/16/blog/MySQL_learning","categories":["SQL"],"updated":"2025-09-14T16:04:23.643Z","content":"<h1 id=\"1.mysql的安装\">1.MySQL的安装<a title=\"#1.mysql的安装\" href=\"#1.mysql的安装\"></a></h1>\n<p>这里是安装在ubuntu 18.04.3下的，首先更新apt，然后安装MySQL：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get update  </span><br><span class=\"line\">apt-get install mysql-server  </span><br></pre></td></tr></table></figure>\n<p>安装完成之后，如果是root用户可以不输入密码，直接运行<code>mysql</code>进入MySQL，查看编码方式</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show variables like &#x27;character_set%&#x27;;  </span><br></pre></td></tr></table></figure>\n<p>一般默认是<code>latin1</code>，将其修改为<code>utf8</code>：<br>\n1.编辑<code>mysqld.cnf</code>:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/mysql/mysql.conf.d/mysqld.cnf  </span><br></pre></td></tr></table></figure>\n<p>在<code>[mysqld]</code>下添加<code>set character_set_server=utf8;</code>;</p>\n<p>2.编辑<code>mysql.cnf</code>：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/mysql/conf.d/mysql.cnf  </span><br></pre></td></tr></table></figure>\n<p>添加<code>default-character-set=utf8</code>;</p>\n<p>3.重启mysql服务：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service mysql restart  </span><br></pre></td></tr></table></figure>\n<h1 id=\"2.mysql常用命令\">2.MySQL常用命令<a title=\"#2.mysql常用命令\" href=\"#2.mysql常用命令\"></a></h1>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#列出数据库列表  </span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> DATABASES;  </span><br><span class=\"line\">#选择数据库  </span><br><span class=\"line\">USE database_name;  </span><br><span class=\"line\">#显示当前数据库的所有列表  </span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> TABLES;  </span><br><span class=\"line\">#显示数据表的属性  </span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> COLUMNS <span class=\"keyword\">FROM</span> table_name;  </span><br><span class=\"line\">#显示数据表的详细索引信息，包括主键  </span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> INDEX <span class=\"keyword\">FROM</span> table_name;  </span><br><span class=\"line\">#输出数据库管理系统的性能及统计信息(表名以&quot;Data&quot;开头的表)  </span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">TABLE</span> STATUS <span class=\"keyword\">from</span> database_name <span class=\"keyword\">LIKE</span> &quot;Data%&quot;\\G;  </span><br></pre></td></tr></table></figure>\n<h1 id=\"3.mysql数据类型\">3.MySQL数据类型<a title=\"#3.mysql数据类型\" href=\"#3.mysql数据类型\"></a></h1>\n<p><strong>数值类型：</strong></p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th>类型</th>\n<th>字节数</th>\n<th>范围(有符号/无符号)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>TINYINT</td>\n<td>1</td>\n<td>- 2^7 ~  2^7 -1 / 0 ~  2^8 -1</td>\n</tr>\n<tr>\n<td>SMALLINT</td>\n<td>2</td>\n<td>- 2^{15} ~  2^{15} -1 / 0 ~  2^{16} -1</td>\n</tr>\n<tr>\n<td>MEDIUMINT</td>\n<td>3</td>\n<td>- 2^{13} ~  2^{23} -1 / 0 ~  2^{24} -1</td>\n</tr>\n<tr>\n<td>INT</td>\n<td>4</td>\n<td>- 2^{31} ~  2^{31} -1 / 0 ~  2^{32} -1</td>\n</tr>\n<tr>\n<td>BIGINT</td>\n<td>8</td>\n<td>- 2^{63} ~  2^{63} -1 / 0 ~  2^{64} -1</td>\n</tr>\n<tr>\n<td>FLOAT[(M,D)]</td>\n<td>4</td>\n<td>(-3.402823466E+38,-1.175494351E-38),0,(1.175494351E-38,3.402823466351E+38)</td>\n</tr>\n<tr>\n<td>DOUBLE[(M,D)]</td>\n<td>8</td>\n<td>(-1.7976931348623157E+308,-2.2250738585072014E-308),0,(2.2250738585072014E-308,1.797693134 8623157E+308)</td>\n</tr>\n<tr>\n<td>DECIMAL[(M,D)]</td>\n<td>依赖M和D</td>\n<td>依赖M和D</td>\n</tr>\n</tbody>\n</table></div></div><p>M表示数字的总位数，D表示小数点后的位数;<br>\n无符号FLOAT的范围:0,(1.175494351E-38,3.402823466E+38);<br>\n无符号DOUBLE的范围:0,(2.2250738585072014E-308,1.7976931348623157E+308)</p>\n<blockquote>\n<p>float和double是以二进制的形式存储的,存储可能会被截断导致精度丢失,所以保存的是一个近似值;<br>\ndecimal是唯一指定能精确存储的类型,比double范围更大,会将9位数字包装为4个字节,也就是用更大的范围来存储;</p>\n</blockquote>\n<p><strong>日期/时间类型：</strong></p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th>类型</th>\n<th>字节数</th>\n<th>范围(有符号)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>YEAR</td>\n<td>1</td>\n<td>1901 ~ 2155</td>\n</tr>\n<tr>\n<td>TIME</td>\n<td>3</td>\n<td>-838:59:59 ~ 838:59:59</td>\n</tr>\n<tr>\n<td>DATE</td>\n<td>3</td>\n<td>1000-01-01 ~ 9999-12-3</td>\n</tr>\n<tr>\n<td>DATETIME</td>\n<td>8</td>\n<td>1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</td>\n</tr>\n<tr>\n<td>TIMESTAMP</td>\n<td>4</td>\n<td>1980-01-01 00:00:01 UTC ~ 2040-01-19 03:14:07 UTC</td>\n</tr>\n</tbody>\n</table></div></div><p><strong>字符串类型：</strong></p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th>类型</th>\n<th>存储需求</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>CHAR(M)</td>\n<td>M字节固定长度,1&lt;=M&lt;255</td>\n</tr>\n<tr>\n<td>VARCHAR(M)</td>\n<td>L+1变长,L&lt; = M,1&lt;=M&lt;=65535</td>\n</tr>\n<tr>\n<td>TINYTEXT</td>\n<td>L+1,L&lt; 2^8</td>\n</tr>\n<tr>\n<td>TEXT</td>\n<td>L+2,L&lt; 2^{16}</td>\n</tr>\n<tr>\n<td>MEDIUMTEXT</td>\n<td>L+3,L&lt; 2^{24}</td>\n</tr>\n<tr>\n<td>LONGTEXT</td>\n<td>L+4,L&lt; 2^{32}</td>\n</tr>\n<tr>\n<td>ENUM</td>\n<td>枚举类型1或2个字节,取决于枚举值的数目（最多65535个）</td>\n</tr>\n<tr>\n<td>SET</td>\n<td>1,2,3,4或8个字节,取决于成员的数目（最多64个）</td>\n</tr>\n</tbody>\n</table></div></div><blockquote>\n<p>CHAR(M)不足M补空格,读取时会删去末尾的空格,VARCHAR(M)是实际长度加一个字节存放长度值;</p>\n</blockquote>\n<p><strong>二进制类型：</strong><br>\n包括BIT,BINARY,VARBINARY,TINYBLOB,BLOB,MEDIUMBLOB,LONGBLOB;</p>\n<h1 id=\"4.mysql基本语法\">4.MySQL基本语法<a title=\"#4.mysql基本语法\" href=\"#4.mysql基本语法\"></a></h1>\n<h3 id=\"1.数据库的操作\">1.数据库的操作<a title=\"#1.数据库的操作\" href=\"#1.数据库的操作\"></a></h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#数据库的创建  </span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> DATABASE [IF <span class=\"keyword\">NOT</span> <span class=\"keyword\">EXISTS</span>] <span class=\"operator\">&lt;</span>数据库名称<span class=\"operator\">&gt;</span> [[<span class=\"keyword\">DEFAULT</span>] <span class=\"keyword\">CHARACTER SET</span> <span class=\"operator\">&lt;</span>字符集名称<span class=\"operator\">&gt;</span>] [[<span class=\"keyword\">DEFAULT</span>] <span class=\"keyword\">COLLATE</span> <span class=\"operator\">&lt;</span>校对规则<span class=\"operator\">&gt;</span>]  </span><br><span class=\"line\">#数据库的修改  </span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> DATABSE [数据库名称] &#123;[<span class=\"keyword\">DEFAULT</span>] <span class=\"type\">CHARACTER</span> <span class=\"operator\">&lt;</span>字符集名称<span class=\"operator\">&gt;</span> [<span class=\"keyword\">DEFAULT</span>] <span class=\"keyword\">COLLATE</span> <span class=\"operator\">&lt;</span>校对规则<span class=\"operator\">&gt;</span>&#125;  </span><br><span class=\"line\">#数据库的删除  </span><br><span class=\"line\"><span class=\"keyword\">DROP</span> DATABASE [IF <span class=\"keyword\">EXISTS</span>] <span class=\"operator\">&lt;</span>数据库名称<span class=\"operator\">&gt;</span>  </span><br></pre></td></tr></table></figure>\n<p>示例：<code>CREATE DATABASE IF NOT EXISTS db1 DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_chinese_ci;</code></p>\n<h3 id=\"2.数据表的操作\">2.数据表的操作<a title=\"#2.数据表的操作\" href=\"#2.数据表的操作\"></a></h3>\n<p><strong>2.1 数据表的创建、修改与删除</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#数据表的创建  </span><br><span class=\"line\"><span class=\"keyword\">CREATE TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> ([<span class=\"operator\">&lt;</span>列名<span class=\"number\">1</span><span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>类型<span class=\"number\">1</span><span class=\"operator\">&gt;</span>,...,<span class=\"operator\">&lt;</span>列名n<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>类型n<span class=\"operator\">&gt;</span>]) [表选项] [分区选项]  </span><br><span class=\"line\">    </span><br><span class=\"line\">#数据表的修改：  </span><br><span class=\"line\">#添加字段  </span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">ADD</span> <span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span> [约束条件] [<span class=\"keyword\">FIRST</span><span class=\"operator\">|</span>AFTER <span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span>]  </span><br><span class=\"line\">#修改数据表字段类型  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> MODIFY <span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">#删除数据表的字段  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">DROP</span> <span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">#修改数据表字段名  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> CHANGE <span class=\"operator\">&lt;</span>旧字段名<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>新字段名<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>新数据类型<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">#修改数据表名  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>旧表名<span class=\"operator\">&gt;</span> RENAME [<span class=\"keyword\">TO</span>] <span class=\"operator\">&lt;</span>新表名<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">    </span><br><span class=\"line\">#数据表的删除  </span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> [IF <span class=\"keyword\">EXISTS</span>] <span class=\"operator\">&lt;</span>表名<span class=\"number\">1</span><span class=\"operator\">&gt;</span> [,<span class=\"operator\">&lt;</span>表名<span class=\"number\">2</span><span class=\"operator\">&gt;</span>,<span class=\"operator\">&lt;</span>表名<span class=\"number\">3</span><span class=\"operator\">&gt;</span>...]  </span><br></pre></td></tr></table></figure>\n<p>示例：<br>\n创建数据表：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE TABLE</span> tb1(  </span><br><span class=\"line\">    id <span class=\"type\">INT</span>(<span class=\"number\">11</span>),  </span><br><span class=\"line\">    name <span class=\"type\">VARCHAR</span>(<span class=\"number\">25</span>),  </span><br><span class=\"line\">    deptId <span class=\"type\">INT</span>(<span class=\"number\">11</span>),  </span><br><span class=\"line\">    salary <span class=\"type\">FLOAT</span>  </span><br><span class=\"line\">);  </span><br></pre></td></tr></table></figure>\n<p>修改数据表的字段类型：<code>ALTER TABLE tb1 MODIFY name VARCHAR(30);</code><br>\n修改数据表字段名：<code>ALTER TABLE tb1 CHANGE name newName VARCHAR(28);</code></p>\n<p><strong>2.2 数据表的查询</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#查询结果去重  </span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> <span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span> <span class=\"keyword\">FROM</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">#设置别名  </span><br><span class=\"line\"><span class=\"operator\">&lt;</span>表名<span class=\"operator\">/</span>字段名<span class=\"operator\">&gt;</span> [<span class=\"keyword\">AS</span>] <span class=\"operator\">&lt;</span>别名<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">#限制查询结果  </span><br><span class=\"line\"><span class=\"operator\">&lt;</span>LINIT<span class=\"operator\">&gt;</span> [<span class=\"operator\">&lt;</span>偏移量<span class=\"operator\">&gt;</span>,] <span class=\"operator\">&lt;</span>行数<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">#查询结果排序  </span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> &#123;<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span><span class=\"operator\">|</span><span class=\"operator\">&lt;</span>表达式<span class=\"operator\">&gt;</span><span class=\"operator\">|</span><span class=\"operator\">&lt;</span>位置<span class=\"operator\">&gt;</span>&#125; [<span class=\"keyword\">ASC</span><span class=\"operator\">|</span><span class=\"keyword\">DESC</span>]  </span><br><span class=\"line\">#查询的<span class=\"keyword\">WHERE</span>条件  </span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> <span class=\"operator\">&lt;</span>查询条件<span class=\"operator\">&gt;</span> &#123;<span class=\"operator\">&lt;</span>判定运算<span class=\"number\">1</span><span class=\"operator\">&gt;</span>,<span class=\"operator\">&lt;</span>判定运算<span class=\"number\">2</span><span class=\"operator\">&gt;</span>,...&#125;  </span><br></pre></td></tr></table></figure>\n<p>判定运算的语法：</p>\n<ul>\n<li>&lt;表达式1&gt; {=|&lt;=|&gt;|&gt;=|&lt;=&gt;|&lt;&gt;|!=} &lt;表达式2&gt;</li>\n<li>&lt;表达式1&gt; [NOT] LIKE &lt;表达式2&gt;</li>\n<li>&lt;表达式1&gt; [NOT] [REGEXP|RLIKE] &lt;表达式2&gt;</li>\n<li>&lt;表达式1&gt; [NOT] BETWEEN &lt;表达式2&gt; AND &lt;表达式3&gt;</li>\n<li>&lt;表达式1&gt; IS [NOT] NULL</li>\n</ul>\n<p>示例：<br>\n查询并通过两个字段排序：<code>SELECT * FROM tb1 ORDER BY age,name;</code><br>\n通过多个字段值条件查询：<code>SELECT name,age FROM tb1 WHERE age&lt;24 AND height&gt;175;</code><br>\n通过字段名模糊查询：<code>SELECT name FROM tb1 WHERE name LIKE 'Z%';</code></p>\n<p><strong>2.3 数据表的连接查询</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">&lt;</span>列名<span class=\"number\">1</span>,列名<span class=\"number\">2.</span>..<span class=\"operator\">&gt;</span> <span class=\"keyword\">FROM</span> <span class=\"operator\">&lt;</span>表名<span class=\"number\">1</span><span class=\"operator\">&gt;</span> <span class=\"keyword\">INNER</span> <span class=\"keyword\">JOIN</span> <span class=\"operator\">&lt;</span>表名<span class=\"number\">2</span><span class=\"operator\">&gt;</span> [<span class=\"keyword\">ON</span>子句]  </span><br></pre></td></tr></table></figure>\n<ul>\n<li>内连接查询：INNER JOIN ON</li>\n<li>左连接查询：LEFT JOIN ON/ LEFT OUTER JOIN ON</li>\n<li>右连接查询：RIGHT JOIN ON/ RIGHT OUTER JOIN ON</li>\n</ul>\n<p>示例：<code>SELECT id,name,dept_name FROM tb1 INNER KOIN tb2 on tb1.dept_id=tb2.dept_id;</code></p>\n<p><strong>2.4 数据表的子查询</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"operator\">&lt;</span>表达式<span class=\"operator\">&gt;</span> [<span class=\"keyword\">NOT</span>] <span class=\"keyword\">IN</span> <span class=\"operator\">&lt;</span>子查询<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\"><span class=\"operator\">&lt;</span>表达式<span class=\"operator\">&gt;</span> &#123;<span class=\"operator\">=</span><span class=\"operator\">|</span><span class=\"operator\">&lt;</span><span class=\"operator\">|</span><span class=\"operator\">&gt;</span><span class=\"operator\">|</span><span class=\"operator\">&gt;=</span><span class=\"operator\">|</span><span class=\"operator\">&lt;=</span><span class=\"operator\">|</span><span class=\"operator\">&lt;=&gt;</span><span class=\"operator\">|</span><span class=\"operator\">&lt;&gt;</span><span class=\"operator\">|</span><span class=\"operator\">!=</span>&#125; &#123;<span class=\"keyword\">ALL</span><span class=\"operator\">|</span><span class=\"keyword\">SOME</span><span class=\"operator\">|</span><span class=\"keyword\">ANY</span>&#125; <span class=\"operator\">&lt;</span>子查询<span class=\"operator\">&gt;</span>  </span><br></pre></td></tr></table></figure>\n<p>示例：<code>SELECT name FROM tb1 WHERE id IN (SELECT id FROM tb2 WHERE grad='A');</code></p>\n<p><strong>2.5 数据表的分组查询</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> &#123;<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span><span class=\"operator\">|</span><span class=\"operator\">&lt;</span>表达式<span class=\"operator\">&gt;</span><span class=\"operator\">|</span><span class=\"operator\">&lt;</span>位置<span class=\"operator\">&gt;</span>&#125; [<span class=\"keyword\">ASC</span><span class=\"operator\">|</span><span class=\"keyword\">DESC</span>]  </span><br><span class=\"line\">#过滤分组  </span><br><span class=\"line\"><span class=\"keyword\">HAVING</span> <span class=\"operator\">&lt;</span>条件<span class=\"operator\">&gt;</span>  </span><br></pre></td></tr></table></figure>\n<p>示例：<br>\n通过id分组并显示大于1的分组内容：<code>SELECT id,GROUP_CONCAT(name) AS names FROM tb1 GROUP BY id HAVING COUNT(name)&gt;1;</code></p>\n<p><strong>总结MySQL的查询语句结构如下：</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> <span class=\"keyword\">column</span>,…  </span><br><span class=\"line\"><span class=\"keyword\">FROM</span> mytable  </span><br><span class=\"line\">    <span class=\"keyword\">JOIN</span> another_table <span class=\"keyword\">ON</span> mytable.column <span class=\"operator\">=</span> another_table.column  </span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> expression1  </span><br><span class=\"line\">    <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> <span class=\"keyword\">column</span>  </span><br><span class=\"line\">    <span class=\"keyword\">HAVING</span> expression2  </span><br><span class=\"line\">    <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> <span class=\"keyword\">column</span> <span class=\"keyword\">ASC</span><span class=\"operator\">/</span><span class=\"keyword\">DESC</span>  </span><br><span class=\"line\">    LIMIT count <span class=\"keyword\">OFFSET</span> COUNT;  </span><br></pre></td></tr></table></figure>\n<h3 id=\"3.记录的操作\">3.记录的操作<a title=\"#3.记录的操作\" href=\"#3.记录的操作\"></a></h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#记录的增加  </span><br><span class=\"line\"><span class=\"keyword\">INSERT INTO</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> [<span class=\"operator\">&lt;</span>列名n<span class=\"operator\">&gt;</span> [,...列名n]] <span class=\"keyword\">VALUES</span> (值<span class=\"number\">1</span>) [...,(值n)]  </span><br><span class=\"line\"><span class=\"keyword\">INSERT INTO</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">SET</span> <span class=\"operator\">&lt;</span>列名<span class=\"number\">1</span><span class=\"operator\">&gt;</span> <span class=\"operator\">=</span> <span class=\"operator\">&lt;</span>值<span class=\"number\">1</span><span class=\"operator\">&gt;</span>, <span class=\"operator\">&lt;</span>列名<span class=\"number\">2</span><span class=\"operator\">&gt;</span> <span class=\"operator\">=</span> <span class=\"operator\">&lt;</span>值<span class=\"number\">2</span><span class=\"operator\">&gt;</span>, ...  </span><br><span class=\"line\">    </span><br><span class=\"line\">#记录的修改  </span><br><span class=\"line\"><span class=\"keyword\">UPDATE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">SET</span> 字段<span class=\"number\">1</span> <span class=\"operator\">=</span> 值<span class=\"number\">1</span> [,字段<span class=\"number\">2</span> <span class=\"operator\">=</span> 值<span class=\"number\">2.</span>..] [<span class=\"keyword\">WHERE</span> 子句] [<span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> 子句] [LIMIT 子句]  </span><br><span class=\"line\">    </span><br><span class=\"line\">#记录的删除  </span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> [<span class=\"keyword\">WHERE</span> 子句] [<span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> 子句] [LIMIT 子句]  </span><br></pre></td></tr></table></figure>\n<p>示例：添加记录：<br>\n<code>INSERT INTO tb_course (name, info) VALUES ('DataBase','MySQL');</code><br>\n<code>INSERT INTO tb_course VALUES (2,'Java','JavaEE');</code><br>\n<code>INSERT INTO tb_course (id,name,info) SELECT course_id,course_name.course_info FROM tb_course2;</code><br>\n示例：更新记录：<br>\n<code>UPDATE tb_course SET name='DB',info='DataBaseCourse' WHERE id=1;</code><br>\n示例：删除记录：<br>\n<code>DELETE FROM tb_course WHERE id=2;</code></p>\n<h3 id=\"4.主键约束\">4.主键约束<a title=\"#4.主键约束\" href=\"#4.主键约束\"></a></h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#设置主键约束  </span><br><span class=\"line\"><span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span> <span class=\"keyword\">PRIMARY KEY</span> [默认值]  </span><br><span class=\"line\">#修改表添加主键约束：  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">ADD</span> <span class=\"keyword\">PRIMARY KEY</span>(<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)  </span><br></pre></td></tr></table></figure>\n<p>示例：<code>ALTER TABLE tb1 ADD PRIMARY KEY(id);</code></p>\n<h3 id=\"5.外键约束\">5.外键约束<a title=\"#5.外键约束\" href=\"#5.外键约束\"></a></h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#设置外键约束  </span><br><span class=\"line\">[<span class=\"keyword\">CONSTRAINT</span> <span class=\"operator\">&lt;</span>外键名<span class=\"operator\">&gt;</span>] <span class=\"keyword\">FOREIGN KEY</span> 列名 [,列名<span class=\"number\">2</span>,...] <span class=\"keyword\">REFERENCES</span> <span class=\"operator\">&lt;</span>主表名<span class=\"operator\">&gt;</span> 列名<span class=\"number\">1</span> [,列名<span class=\"number\">2</span>,...]  </span><br><span class=\"line\">#修改表添加外键约束：  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">ADD CONSTRAINT</span> <span class=\"operator\">&lt;</span>索引名<span class=\"operator\">&gt;</span> <span class=\"keyword\">FOREIGN KEY</span>(<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>) <span class=\"keyword\">REFERENCES</span> <span class=\"operator\">&lt;</span>主表名<span class=\"operator\">&gt;</span>(<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)  </span><br><span class=\"line\">#删除表的外键约束：  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">DROP</span> <span class=\"keyword\">FOREIGN KEY</span> <span class=\"operator\">&lt;</span>外键约束名<span class=\"operator\">&gt;</span>  </span><br></pre></td></tr></table></figure>\n<p>示例：将tb2上的depId作为外键关联到tb1的主键id：<br>\n<code>CONSTRAINT cons FOREIGN KEY(depId) REFERENCES tb1(id);</code></p>\n<h3 id=\"6.唯一约束和非空约束\">6.唯一约束和非空约束<a title=\"#6.唯一约束和非空约束\" href=\"#6.唯一约束和非空约束\"></a></h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#设置唯一约束  </span><br><span class=\"line\"><span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span> <span class=\"keyword\">UNIQUE</span>  </span><br><span class=\"line\">#修改表添加唯一约束  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>数据表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">ADD CONSTRAINT</span> <span class=\"operator\">&lt;</span>唯一约束名<span class=\"operator\">&gt;</span> <span class=\"keyword\">UNIQUE</span>(<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)  </span><br><span class=\"line\">#删除字段的唯一约束  </span><br><span class=\"line\"><span class=\"keyword\">ALTER TABLE</span> <span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span> <span class=\"keyword\">DROP</span> INDEX <span class=\"operator\">&lt;</span>唯一约束名<span class=\"operator\">&gt;</span>  </span><br><span class=\"line\">    </span><br><span class=\"line\">#设置非空约束  </span><br><span class=\"line\"><span class=\"operator\">&lt;</span>字段名<span class=\"operator\">&gt;</span> <span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span> <span class=\"keyword\">NOT NULL</span>;  </span><br></pre></td></tr></table></figure>\n<p>示例：<br>\n<code>ALTER TABLE tb_course ADD CONSTRAINT unique_name UNIQUE(name);</code><br>\n<code>ALTER TABLE tb_course DROP INDEX unique_name;</code></p>\n","prev":{"title":"数据结构：字典(Trie)树的实现(Java)","link":"2020/03/27/blog/TrieTree"},"next":{"title":"Java-动态规划算法","link":"2020/03/09/blog/Java_DynamicProgramming"},"plink":"https://qfzack.github.io/2020/03/16/blog/MySQL_learning/","toc":[{"id":"1.mysql的安装","title":"1.MySQL的安装","index":"1"},{"id":"2.mysql常用命令","title":"2.MySQL常用命令","index":"2"},{"id":"3.mysql数据类型","title":"3.MySQL数据类型","index":"3"},{"id":"4.mysql基本语法","title":"4.MySQL基本语法","index":"4","children":[{"id":"1.数据库的操作","title":"1.数据库的操作","index":"4.1"},{"id":"2.数据表的操作","title":"2.数据表的操作","index":"4.2"},{"id":"3.记录的操作","title":"3.记录的操作","index":"4.3"},{"id":"4.主键约束","title":"4.主键约束","index":"4.4"},{"id":"5.外键约束","title":"5.外键约束","index":"4.5"},{"id":"6.唯一约束和非空约束","title":"6.唯一约束和非空约束","index":"4.6"}]}],"reading_time":"1935 words in 13 min"}