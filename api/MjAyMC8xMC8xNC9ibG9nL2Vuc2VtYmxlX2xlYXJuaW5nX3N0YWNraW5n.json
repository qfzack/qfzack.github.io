{"title":"Machine-Learing：集成学习-stacking","date":"2020-10-13T21:00:00.000Z","date_formatted":{"ll":"Oct 14, 2020","L":"10/14/2020","MM-DD":"10-14"},"author":"Qingfeng Zhang","link":"2020/10/14/blog/ensemble_learning_stacking","categories":["Machine Learning"],"updated":"2025-04-12T14:12:03.421Z","content":"<p>集成学习的思想是通过合并多个模型来提升机器学习的学习性能；<br>\n集成学习的方法可分为3种：Bagging,Boosting,Stacking;<br>\nbagging用于减小方差；<br>\nboosting用于减少偏差；<br>\nstacking有助于提升预测结果</p>\n<h2 id=\"1.stacking的思想\">1.stacking的思想<a title=\"#1.stacking的思想\" href=\"#1.stacking的思想\"></a></h2>\n<ul>\n<li>stacking是通过一个元分类器或者元回归器来整合多个分类模型或回归模型的集成学习技术；</li>\n<li>基础模型利用整个训练集进行训练，元模型将基础模型的特征作为特征进行训练；</li>\n<li>基础模型通常包含不同的学习算法，因此stacking通常是”异质集成“的；</li>\n</ul>\n<p>Otto Group<br>\nProduct分类挑战赛中，第一名的获得者通对30个模型进行stacking，将30个模型的输出作为特征，继续在XGboost，Meural<br>\nNetwork和Adaboost中进行训练，最后加权平均得到最后的结果；<br>\nKaggle上关于stacking的一个分享 <a href=\"https://www.kaggle.com/c/otto-group-product-classification-challenge/discussion/14335\" target=\"_blank\">https://www.kaggle.com/c/otto-group-product-classification-challenge/discussion/14335</a></p>\n<h2 id=\"2.stacking的框架流程\">2.stacking的框架流程<a title=\"#2.stacking的框架流程\" href=\"#2.stacking的框架流程\"></a></h2>\n<p>stacking用到了交叉验证的思想，假设使用5折交叉验证，stacking的框架如下：</p>\n<ol>\n<li>选择一个基模型；</li>\n<li>把训练数据集分为不交叉的5份，记为train1到train5；</li>\n<li>分别把train1到train5作为测试集，其他的数据作为训练集，使用训练的模型分别对train1到train5进行预测，得到5个预测结果，这5个结果可以拼成与原始train长度相等的数据，将其作为第一个基模型对train数据集的一个stacking转换；</li>\n<li>将上述的5个模型分别对test数据集进行预测，也得到5个预测结果，取5个结果的平均值，将其作为第一个基模型对test数据集的一个stacking转换；</li>\n<li>选择第二个基模型， 重复上述2-4的步骤，可以得到第二个基模型对train和test数据集的一个stacking转换；</li>\n</ol>\n<p>以下两张图描述的就是stacking的过程：<br>\n<img src=\"images/ensemble_learning_stacking/stacking1.jpg\" alt=\"\" loading=\"lazy\"><br>\n<img src=\"images/ensemble_learning_stacking/stacking2.jpg\" alt=\"\" loading=\"lazy\"><br>\n上图表示使用XGBoost和random forest模型进行stacking的过程，使用5折交叉验证，<br>\n对于数据集train和test（假设train的长度为N，test的长度为M），XGB和RF都可以将其重新表达得到新的train和test（都只有一列），因此有两份train和test的stacking转换，而train和test都是含有标签的，因此新的train是一个N行两列的数据，标签为N行一列，新的test是一个M行两列的数据，标签为M行一列，对于新的train和新的test，让下一层的模型基于这些数据进行训练；<br>\n也可以在第二层使用一个LR（logistic回归）模型基于新的train和新的test进行训练。</p>\n","prev":{"title":"Java学习小记","link":"2020/11/05/blog/Java_learning"},"next":{"title":"Machine-Learing：GBDT与XGBoost","link":"2020/10/14/blog/gbdt_xgboost"},"plink":"https://github.com/qfzack/2020/10/14/blog/ensemble_learning_stacking/","toc":[{"id":"1.stacking的思想","title":"1.stacking的思想","index":"1"},{"id":"2.stacking的框架流程","title":"2.stacking的框架流程","index":"2"}],"copyright":{"author":"Qingfeng Zhang","link":"<a href=\"https://github.com/qfzack/2020/10/14/blog/ensemble_learning_stacking/\" title=\"Machine-Learing：集成学习-stacking\">https://github.com/qfzack/2020/10/14/blog/ensemble_learning_stacking/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"},"reading_time":"719 words in 5 min"}